from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from pyvirtualdisplay import Display

import random
import time


voteCount = 850
pollID = "13633762"
answerID = "60898864"
showDisplay = True # Choose between displaying the browsers or running them in the background (recommend to run in the background unless you wanna watch)
voteDelay = False # Delay in seconds 

# Replace with your compatible driver path (https://www.selenium.dev/selenium/docs/api/py/#drivers)
driverPath = 'chromedriver-win64\\chromedriver.exe'
userAgentsPath = 'user_agents.txt'

def read_lines(filename):
    with open(filename, 'r') as file:
        return [line.strip() for line in file]

def setup_driver():
    options = Options()
    user_agents = read_lines(userAgentsPath)
    user_agent = random.choice(user_agents)
    options.add_argument(f"user-agent={user_agent}")

    if showDisplay == False: 
        options.add_argument("--headless")
        options.add_argument("--window-size=%s" % "1920,1080")

    service = Service(driverPath)
    return webdriver.Chrome(service=service, options=options)

def main():
    for i in range(voteCount):
        
        # Setup Driver
        driver = setup_driver()
        driver.get("https://poll.fm/" + pollID)

        targetOption = driver.find_element(By.ID, "PDI_answer" + answerID)
        driver.execute_script("arguments[0].click();", targetOption)
        vote_button = driver.find_element(By.ID, "pd-vote-button" + pollID)
        driver.execute_script("arguments[0].click();", vote_button)

        print("Voted Successfully #", i + 1)

        # Made vote delay optional
        if voteDelay:
            time.sleep(random.randint(1,3)) 

        driver.quit()

if __name__ == '__main__':
    main()
